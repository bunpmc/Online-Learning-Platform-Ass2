@page
@model OnlineLearningPlatformAss2.RazorWebApp.Pages.TestChatbotModel
@{
    ViewData["Title"] = "Test Chatbot";
}

<h1>Test Chatbot</h1>

<div class="row">
    <div class="col-md-8">
        <div id="chat-history" style="height: 400px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
            @if (Model.History != null)
            {
                foreach (var item in Model.History)
                {
                    <div class="mb-2">
                        <strong>@item.Role:</strong> <span>@item.Content</span>
                    </div>
                }
            }
        </div>

        <form method="post">
            <div class="input-group">
                <input type="text" class="form-control" name="Question" placeholder="Ask a question..." required />
                <button type="submit" class="btn btn-primary">Send</button>
            </div>
            <!-- Preserve history -->
            @if (Model.History != null)
            {
                for (int i = 0; i < Model.History.Count; i++)
                {
                    <input type="hidden" name="History[@i].Role" value="@Model.History[i].Role" />
                    <input type="hidden" name="History[@i].Content" value="@Model.History[i].Content" />
                }
            }
        </form>
    </div>
</div>

@if (!string.IsNullOrEmpty(Model.ErrorMessage))
{
    <div class="alert alert-danger mt-4">
        @Model.ErrorMessage
    </div>
}
